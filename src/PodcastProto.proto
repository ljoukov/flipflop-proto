syntax = "proto3";

import "google/protobuf/duration.proto";
import "google/protobuf/timestamp.proto";

message PodcastStreamApiRequestProto {
  string encoded_user_auth = 1;
  oneof request {
    CreatePodcastPreviewRequestProto create_preview = 2;
  }
}

message PodcastStreamApiResponseHeaderProto {
  // If present the token was refreshed and the client should use this new one
  // from now onwards.
  string refreshed_encoded_user_auth = 1;
  oneof header {
    CreatePodcastPreviewResponseHeaderProto create_preview_header = 2;
  }
  map<string, google.protobuf.Duration> latencies = 100;
}

message PodcastStreamApiResponseDeltaProto {
  oneof response_delta {
    CreatePodcastPreviewResponseDeltaProto create_preview_delta = 1;
  }
}

message CreatePodcastPreviewRequestProto {
  string prompt = 1;
}

message CreatePodcastPreviewResponseHeaderProto {}

message CreatePodcastPreviewResponseDeltaProto {
  oneof type {
    bool separator = 1;

    // This is the last delta message
    bool error_no_topic = 2;

    // IDs start at 10
    PodcastPreviewProto preview_delta = 10;
  }
}

message PodcastPreviewProto {
  string podcast_id = 1;

  string created_by = 2;
  google.protobuf.Timestamp created_at = 3;

  string title = 4;
  string title_emoji = 5;
  string synopsis = 6;
}

enum PodcastHostProto {
  PODCAST_HOST_PROTO_UNKNOWN = 0;
  PODCAST_HOST_PROTO_MALE = 1;
  PODCAST_HOST_PROTO_FEMALE = 2;
}

message PodcastTranscriptEntry {
  PodcastHostProto host = 1;
  string text = 2;
}

message PodcastProto {
  string podcast_id = 1;

  string created_by = 2;
  google.protobuf.Timestamp created_at = 3;

  string reasoning = 4;
  string title = 5;
  string title_emoji = 6;
  string synopsis = 7;

  string plan = 8;
  repeated PodcastTranscriptEntry transcript = 9;
}
